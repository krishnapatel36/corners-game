<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Corners Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    h1 {
      margin-bottom: 10px;
    }
    #gameBoard {
      display: grid;
      grid-template-columns: repeat(7, 50px);
      grid-template-rows: repeat(7, 50px);
      gap: 5px;
      justify-content: center;
      margin: 20px auto;
    }
    .cell {
      width: 50px;
      height: 50px;
      background: white;
      border: 2px solid #ccc;
      cursor: pointer;
    }
    .red { background: red; }
    .blue { background: blue; }
    .claimed { border: 3px solid gold; }
    #controls {
      margin: 20px;
    }
    button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
    }
    #score {
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Corners Game</h1>
  <div id="controls">
    <button onclick="resetGame()">Restart</button>
    <button onclick="toggleMode()">Mode: 2 Player</button>
    <div id="score">Red: 0 | Blue: 0</div>
  </div>
  <div id="gameBoard"></div>

  <script>
    const size = 7;
    let currentPlayer = 'red';
    let mode = '2player';
    let board = [];
    let score = { red: 0, blue: 0 };

    const gameBoard = document.getElementById('gameBoard');
    const scoreDisplay = document.getElementById('score');
    const modeButton = document.querySelector('#controls button:nth-child(2)');

    function createBoard() {
      gameBoard.innerHTML = '';
      board = [];
      for (let r = 0; r < size; r++) {
        let row = [];
        for (let c = 0; c < size; c++) {
          const cell = document.createElement('div');
          cell.className = 'cell';
          cell.dataset.row = r;
          cell.dataset.col = c;
          cell.onclick = () => handleClick(r, c, cell);
          gameBoard.appendChild(cell);
          row.push(null);
        }
        board.push(row);
      }
    }

    function handleClick(r, c, cell) {
      if (board[r][c]) return; // already taken
      board[r][c] = currentPlayer;
      cell.classList.add(currentPlayer);
      checkAndMarkSquares();
      updateScore();
      if (mode === 'vsComputer' && currentPlayer === 'red') {
        currentPlayer = 'blue';
        setTimeout(computerMove, 300);
      } else {
        currentPlayer = currentPlayer === 'red' ? 'blue' : 'red';
      }
    }

    function checkAndMarkSquares() {
      for (let r1 = 0; r1 < size; r1++) {
        for (let c1 = 0; c1 < size; c1++) {
          for (let r2 = r1 + 1; r2 < size; r2++) {
            for (let c2 = c1 + 1; c2 < size; c2++) {
              if (
                board[r1][c1] === currentPlayer &&
                board[r1][c2] === currentPlayer &&
                board[r2][c1] === currentPlayer &&
                board[r2][c2] === currentPlayer
              ) {
                claimCorner(r1, c1);
                claimCorner(r1, c2);
                claimCorner(r2, c1);
                claimCorner(r2, c2);
              }
            }
          }
        }
      }
    }

    function claimCorner(r, c) {
      const index = r * size + c;
      const cell = gameBoard.children[index];
      if (!cell.classList.contains('claimed')) {
        cell.classList.add('claimed');
        score[currentPlayer]++;
      }
    }

    function updateScore() {
      scoreDisplay.textContent = `Red: ${score.red} | Blue: ${score.blue}`;
    }

    function computerMove() {
      let empty = [];
      for (let r = 0; r < size; r++) {
        for (let c = 0; c < size; c++) {
          if (!board[r][c]) empty.push({ r, c });
        }
      }
      if (empty.length === 0) return;
      const { r, c } = empty[Math.floor(Math.random() * empty.length)];
      const cell = gameBoard.children[r * size + c];
      handleClick(r, c, cell);
    }

    function resetGame() {
      currentPlayer = 'red';
      score = { red: 0, blue: 0 };
      updateScore();
      createBoard();
    }

    function toggleMode() {
      mode = mode === '2player' ? 'vsComputer' : '2player';
      modeButton.textContent = `Mode: ${mode === '2player' ? '2 Player' : 'Vs Computer'}`;
      resetGame();
    }

    // Init
    createBoard();
  </script>
</body>
</html>